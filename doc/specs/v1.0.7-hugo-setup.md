# v1.0.7：Hugo 靜態網站基礎建設

## 目標

建立 Hugo 靜態網站框架，將現有 Markdown 卡片轉換為可瀏覽的部落格網頁，並設定 GitHub Pages 自動部署。

## 技術決策

| 項目 | 決策 | 理由 |
|------|------|------|
| Hugo 主題 | PaperMod | 簡潔、快速、支援搜尋和分類，適合知識庫類型網站 |
| 部署方式 | gh-pages 分支 | 簡單直接，適合單一專案 |
| CI/CD | GitHub Actions | 與 GitHub Pages 整合良好 |

---

## 驗收條件

### AC-1: Hugo 專案結構完整

- [ ] `hugo.toml` 配置檔存在且正確
- [ ] PaperMod 主題已安裝（git submodule）
- [ ] 基本站點可在本地 `hugo server` 預覽

### AC-2: 卡片內容整合

- [ ] zettelkasten/ 目錄的卡片可作為 Hugo content
- [ ] 卡片的 frontmatter 與 Hugo 相容
- [ ] 分類頁面可正確顯示

### AC-3: GitHub Pages 部署

- [ ] `.github/workflows/hugo.yml` 配置完成
- [ ] Push to main 自動觸發建置
- [ ] 網站成功部署到 gh-pages 分支

### AC-4: 導航與連結

- [ ] 首頁顯示最新卡片列表
- [ ] 分類導航正常運作
- [ ] 卡片間的相對連結可正確跳轉

---

## 實作步驟

### Step 1: Hugo 專案初始化

```
1.1 建立 Hugo 配置檔 hugo.toml
    - 設定網站基本資訊（title, baseURL, languageCode）
    - 設定主題為 PaperMod

1.2 安裝 PaperMod 主題為 git submodule
    - git submodule add https://github.com/adityatelange/hugo-PaperMod themes/PaperMod

1.3 建立基本目錄結構
    - layouts/（自訂模板）
    - static/（靜態資源）
    - assets/（CSS/JS 資源）
```

### Step 2: 內容整合

```
2.1 設定 content 目錄
    - 方案 A：符號連結 content -> zettelkasten
    - 方案 B：在 hugo.toml 設定 contentDir = "zettelkasten"

2.2 建立 archetypes/default.md 模板
    - 符合現有卡片格式

2.3 調整卡片 frontmatter 格式（若需要）
    - 確保 title、date、tags 等欄位相容
    - 處理 type 欄位的對應

2.4 建立分類索引頁面
    - 為每個分類（noun, verb-ru 等）建立 _index.md
```

### Step 3: 主題配置

```
3.1 配置 PaperMod 主題參數
    - 在 hugo.toml 的 [params] 區塊設定

3.2 設定首頁 profile 模式
    - 顯示專案說明和快速導航

3.3 配置搜尋功能
    - 啟用 PaperMod 內建搜尋
    - 建立 search.md 頁面

3.4 設定分類和標籤顯示
    - 配置 taxonomies
    - 設定分類頁面樣式
```

### Step 4: GitHub Actions Workflow

```yaml
# .github/workflows/hugo.yml
name: Deploy Hugo site to Pages

on:
  push:
    branches: ["main"]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

defaults:
  run:
    shell: bash

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      HUGO_VERSION: 0.121.0
    steps:
      - name: Install Hugo CLI
        run: |
          wget -O ${{ runner.temp }}/hugo.deb https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_extended_${HUGO_VERSION}_linux-amd64.deb \
          && sudo dpkg -i ${{ runner.temp }}/hugo.deb
      - name: Checkout
        uses: actions/checkout@v4
        with:
          submodules: recursive
      - name: Setup Pages
        id: pages
        uses: actions/configure-pages@v4
      - name: Build with Hugo
        env:
          HUGO_ENVIRONMENT: production
        run: |
          hugo \
            --minify \
            --baseURL "${{ steps.pages.outputs.base_url }}/"
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v2
        with:
          path: ./public

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v3
```

### Step 5: 驗證與調整

```
5.1 本地測試所有頁面
    - hugo server -D
    - 檢查每個分類是否正確顯示

5.2 檢查連結正確性
    - 確認卡片間的 [text](path.md) 連結可跳轉
    - 確認 _meta 標籤連結正常

5.3 Push 並確認自動部署
    - 觀察 GitHub Actions 執行結果
    - 確認無建置錯誤

5.4 驗證線上網站功能
    - 訪問部署後的網址
    - 測試搜尋功能
    - 測試導航功能
```

---

## 預計新增/修改檔案

```
japanese_learning_blog/
├── hugo.toml                          # [新增] Hugo 配置
├── .github/
│   └── workflows/
│       └── hugo.yml                   # [新增] GitHub Actions
├── themes/
│   └── PaperMod/                      # [新增] git submodule
├── layouts/                           # [新增] 自訂模板
│   ├── _default/
│   │   └── baseof.html               # 基礎模板（若需自訂）
│   └── partials/                      # 部分模板（若需自訂）
├── static/                            # [新增] 靜態資源
│   └── favicon.ico                    # 網站圖示
├── assets/                            # [新增] CSS/JS 資源
│   └── css/
│       └── extended/
│           └── custom.css             # 自訂樣式
├── archetypes/
│   └── default.md                     # [新增] 預設模板
└── content/                           # [配置] 指向 zettelkasten/
```

---

## 測試重點

### 本地測試

```bash
# 1. 啟動開發伺服器
hugo server -D

# 2. 檢查以下頁面
- 首頁（http://localhost:1313/）
- 分類頁（http://localhost:1313/noun/）
- 單一卡片頁（http://localhost:1313/noun/001_asagohan/）
- 搜尋頁（http://localhost:1313/search/）
- 標籤頁（http://localhost:1313/tags/）
```

### 連結測試

```bash
# 確認卡片間連結正確跳轉
- 點擊「相關連結」區塊的連結
- 點擊腳註連結
- 確認 _meta 標籤連結
```

### 部署測試

```bash
# 確認 GitHub Actions
- Push 後 Actions 自動執行
- 建置無錯誤
- 部署成功

# 確認線上網站
- 網址可訪問
- 內容正確顯示
- 搜尋功能正常
```

---

## 風險與注意事項

### 潛在問題

1. **Frontmatter 相容性**
   - Hugo 對某些 YAML 格式敏感
   - 可能需要調整 `type` 欄位名稱（與 Hugo 內建衝突）

2. **連結格式**
   - 現有的 `[text](path.md)` 格式可能需要調整為 Hugo 的 shortcode
   - 跨分類連結路徑需確認

3. **大量檔案建置時間**
   - 433+ 張卡片可能影響建置速度
   - 考慮使用 Hugo 的增量建置功能

### 解決方案

1. 建立 `hugo.toml` 時預先處理已知的 frontmatter 問題
2. 建置前執行連結格式檢查腳本
3. 使用 Hugo Extended 版本確保最佳效能

---

## 相關資源

- [Hugo 官方文檔](https://gohugo.io/documentation/)
- [PaperMod 主題文檔](https://github.com/adityatelange/hugo-PaperMod)
- [GitHub Pages with Hugo](https://gohugo.io/hosting-and-deployment/hosting-on-github/)

---

**建立日期**：2024-12-17
**預計開發分支**：`feature/v1.0.7-hugo-setup`
