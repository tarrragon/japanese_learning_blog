---
name: macos-dictionary
description: |
  查詢 macOS 內建字典（日文、中文、英文）。
  使用時機：當用戶詢問日文單字的讀音、詞性、定義，英文詞彙的中日文翻譯，或中文詞彙的英文翻譯時。
  關鍵字：查字典、怎麼唸、什麼意思、日文定義、詞性、用日文解釋、英翻日、英翻中、中翻英。
---

# macOS 多語字典查詢

## 功能說明

使用 macOS 內建的 DictionaryServices API 查詢多語字典，提供權威的讀音、詞性和定義資料。

## 支援的字典與查詢方向

### 日文字典

| 字典 | 出版社 | 查詢方向 | 提供資料 |
|------|--------|----------|----------|
| スーパー大辞林 | 三省堂 | 日文 → 日文 | 讀音、詞性、日文定義 |
| ウィズダム和英辞典 | 三省堂 | 日文 → 英文 | 英文翻譯、例句 |
| ウィズダム英和辞典 | 三省堂 | 英文 → 日文 | 日文翻譯、用法說明 |

### 中文字典（繁體）

| 字典 | 類型 | 查詢方向 | 提供資料 |
|------|------|----------|----------|
| 國語辭典 | 繁體中文 | 中文 → 中文 | 注音、解釋、例句 |
| 譯典通英漢雙向字典 | 英漢/漢英 | 英文 ↔ 中文 | 翻譯、同義詞、例句 |

**注意**：僅支援**繁體中文**，簡體字（如「国债」）查不到。

### 查詢方向範例

| 用戶需求 | 查詢方式 | 使用字典 |
|----------|----------|----------|
| 「食べる 怎麼唸？」 | 日文詞彙 | スーパー大辞林 |
| 「食べる 的英文？」 | 日文詞彙 | ウィズダム和英 |
| 「national debt 的日文？」 | 英文詞彙 | ウィズダム英和 |
| 「computer 的中文？」 | 英文詞彙 | 譯典通英漢 |
| 「經濟 是什麼意思？」 | 中文詞彙 | 國語辭典 |

## 使用方式

執行以下命令查詢詞彙：

```bash
# JSON 格式輸出（預設）
uv run scripts/lookup-dictionary.py <詞彙>

# 日文詞彙查詢
uv run scripts/lookup-dictionary.py 食べる
uv run scripts/lookup-dictionary.py 美しい

# 英文詞彙查詢
uv run scripts/lookup-dictionary.py "national debt"    # 英文 → 日文
uv run scripts/lookup-dictionary.py computer           # 英文 → 中文

# 中文詞彙查詢（繁體）
uv run scripts/lookup-dictionary.py 經濟               # 中文解釋
uv run scripts/lookup-dictionary.py 電腦               # 中文解釋

# 原始字典文字（查看完整內容）
uv run scripts/lookup-dictionary.py 食べる --raw
uv run scripts/lookup-dictionary.py computer --raw
uv run scripts/lookup-dictionary.py 民主 --raw
```

### 查詢注意事項

**英文查詢**：
- 可能同時返回日文（ウィズダム英和）和中文（譯典通）結果
- 使用 `--raw` 查看完整內容
- 複合詞需用引號包圍：`"national debt"`

**中文查詢**：
- 僅支援**繁體中文**
- 返回國語辭典結果（含注音、倉頡碼）
- 簡體字查不到（如「国债」→ 需改用「國債」）

## 輸出格式

```json
{
  "query": "食べる",
  "found": true,
  "sources": {
    "daijirin": true,
    "waei": true
  },
  "data": {
    "reading": "たべる",
    "kanji": "食べる",
    "pos": "動詞",
    "pos_details": "一段動詞（下一段）",
    "definition_ja": "食物を口に入れ...",
    "definition_en": "eat; have a meal"
  }
}
```

## 輸出欄位說明

| 欄位 | 說明 |
|------|------|
| `reading` | 假名讀音 |
| `kanji` | 漢字表記 |
| `pos` | 詞性（動詞、名詞、形容詞等） |
| `pos_details` | 詞性細節（一段動詞、五段動詞等） |
| `definition_ja` | 日文定義（來自スーパー大辞林） |
| `definition_en` | 英文翻譯（來自ウィズダム和英辞典） |

## 中日共用漢字處理

### 問題說明

許多漢字詞彙在中文和日文中都存在（如「勉強」「大丈夫」「人参」），macOS 字典可能返回中文結果而非日文結果。

### 識別中文結果的特徵

當 `--raw` 輸出包含以下特徵時，表示返回的是**中文字典**結果：
- 注音符號（ㄅㄆㄇ）
- 拼音標記（miǎn qiǎng）
- 倉頡碼（弓山大尸）
- 繁體中文解釋風格

### 處理策略

**步驟 1：判斷用戶意圖**

根據對話上下文判斷用戶想查的是日文還是中文：
- 本專案是日文學習系統，**預設查詢日文**
- 如果用戶明確說「中文」或「國語」，則提供中文結果

**步驟 2：查詢並檢查結果**

1. 先用 `--raw` 查詢，檢查返回的是日文還是中文結果
2. 如果是中文結果且用戶想查日文，採用以下策略：

**策略 A：用假名形式重新查詢**
```bash
# 原查詢返回中文
uv run scripts/lookup-dictionary.py 勉強 --raw
# → 返回中文注音結果

# 改用假名查詢
uv run scripts/lookup-dictionary.py べんきょう --raw
# → 可能返回日文結果
```

**策略 B：提供 AI 知識補充**

如果假名查詢也無法獲得日文結果，使用 AI 知識回答，並標註：
```
⚠️ 字典返回中文結果，以下為 AI 提供的日文解釋：

【勉強】べんきょう
詞性：名詞・サ變動詞
日文：学問や技術を学ぶこと
英文：study; learning
中文：學習、讀書
```

### 常見中日共用漢字對照

| 漢字 | 日文讀音 | 日文意思 | 中文意思 | 差異 |
|------|----------|----------|----------|------|
| 勉強 | べんきょう | 學習 | 勉強、不情願 | 意思不同 |
| 大丈夫 | だいじょうぶ | 沒問題、沒關係 | 男子漢 | 意思不同 |
| 人参 | にんじん | 胡蘿蔔 | 人參 | 指不同事物 |
| 手紙 | てがみ | 信件 | 衛生紙 | 指不同事物 |
| 娘 | むすめ | 女兒 | 媽媽 | 意思相反 |
| 先生 | せんせい | 老師、醫生 | 先生（稱呼） | 用法不同 |

## 限制

- **僅限 macOS**：依賴 DictionaryServices.framework
- **需啟用字典**：用戶必須在「字典」應用程式中啟用日文字典
- **查不到的情況**：專有名詞、新詞、複合詞可能查不到
- **中日共用漢字**：可能返回中文結果，需按上述策略處理

## 回應用戶的格式建議

### 日文詞彙查詢

當用戶詢問日文單字時，以清晰的格式回應：

```
【食べる】たべる
詞性：一段動詞（下一段）
日文：食物を口に入れ，かんで飲み込む。
英文：eat; have a meal
```

### 英文詞彙查詢（英翻日）

當用戶詢問英文詞彙的日文翻譯時：

```
【national debt】
日文翻譯：国家負債、国債
美式用法：public debt
備註：通常用單數形
```

### 英文詞彙查詢（英翻中）

當用戶詢問英文詞彙的中文翻譯時：

```
【computer】
中文翻譯：電腦、電子計算機
詞性：名詞（可數）
同義詞：calculator, microcomputer, laptop
```

### 中文詞彙查詢

當用戶詢問中文詞彙的解釋時：

```
【經濟】ㄐㄧㄥ ㄐㄧˋ
注音：ㄐㄧㄥ ㄐㄧˋ
拼音：jīng jì
解釋：
① 關於財貨的生產、分配、消費等事項
② 節約，以較少耗費獲得較大成果
③ 經世濟民，治理國家
```

## 技術文檔

詳細的 API 說明和整合指南請參考：`doc/macos-dictionary-services.md`
