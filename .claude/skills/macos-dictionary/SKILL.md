---
name: macos-dictionary
description: |
  查詢 macOS 內建字典（日文、中文、英文）。
  使用時機：當用戶詢問日文單字的讀音、詞性、定義，英文詞彙的中日文翻譯，或中文詞彙的英文翻譯時。
  關鍵字：查字典、怎麼唸、什麼意思、日文定義、詞性、用日文解釋、英翻日、英翻中、中翻英。
---

# macOS 多語字典查詢

## 功能說明

使用 macOS 內建的 DictionaryServices API 查詢多語字典，提供權威的讀音、詞性和定義資料。

## 支援的字典與查詢方向

### 日文字典

| 字典 | 出版社 | 查詢方向 | 提供資料 |
|------|--------|----------|----------|
| スーパー大辞林 | 三省堂 | 日文 → 日文 | 讀音、詞性、日文定義 |
| ウィズダム和英辞典 | 三省堂 | 日文 → 英文 | 英文翻譯、例句 |
| ウィズダム英和辞典 | 三省堂 | 英文 → 日文 | 日文翻譯、用法說明 |

### 中文字典（繁體）

| 字典 | 類型 | 查詢方向 | 提供資料 |
|------|------|----------|----------|
| 國語辭典 | 繁體中文 | 中文 → 中文 | 注音、解釋、例句 |
| 譯典通英漢雙向字典 | 英漢/漢英 | 英文 ↔ 中文 | 翻譯、同義詞、例句 |

**注意**：僅支援**繁體中文**，簡體字（如「国债」）查不到。

### 查詢方向範例

| 用戶需求 | 查詢方式 | 使用字典 |
|----------|----------|----------|
| 「食べる 怎麼唸？」 | 日文詞彙 | スーパー大辞林 |
| 「食べる 的英文？」 | 日文詞彙 | ウィズダム和英 |
| 「national debt 的日文？」 | 英文詞彙 | ウィズダム英和 |
| 「computer 的中文？」 | 英文詞彙 | 譯典通英漢 |
| 「經濟 是什麼意思？」 | 中文詞彙 | 國語辭典 |

## 使用方式

執行以下命令查詢詞彙：

```bash
# JSON 格式輸出（預設）
uv run scripts/lookup-dictionary.py <詞彙>

# 日文詞彙查詢
uv run scripts/lookup-dictionary.py 食べる
uv run scripts/lookup-dictionary.py 美しい

# 英文詞彙查詢
uv run scripts/lookup-dictionary.py "national debt"    # 英文 → 日文
uv run scripts/lookup-dictionary.py computer           # 英文 → 中文

# 中文詞彙查詢（繁體）
uv run scripts/lookup-dictionary.py 經濟               # 中文解釋
uv run scripts/lookup-dictionary.py 電腦               # 中文解釋

# 原始字典文字（查看完整內容）
uv run scripts/lookup-dictionary.py 食べる --raw
uv run scripts/lookup-dictionary.py computer --raw
uv run scripts/lookup-dictionary.py 民主 --raw
```

### 查詢注意事項

**英文查詢**：
- 可能同時返回日文（ウィズダム英和）和中文（譯典通）結果
- 使用 `--raw` 查看完整內容
- 複合詞需用引號包圍：`"national debt"`

**中文查詢**：
- 僅支援**繁體中文**
- 返回國語辭典結果（含注音、倉頡碼）
- 簡體字查不到（如「国债」→ 需改用「國債」）

## 輸出格式

```json
{
  "query": "食べる",
  "found": true,
  "sources": {
    "daijirin": true,
    "waei": true
  },
  "data": {
    "reading": "たべる",
    "kanji": "食べる",
    "pos": "動詞",
    "pos_details": "一段動詞（下一段）",
    "definition_ja": "食物を口に入れ...",
    "definition_en": "eat; have a meal"
  }
}
```

## 輸出欄位說明

| 欄位 | 說明 |
|------|------|
| `reading` | 假名讀音 |
| `kanji` | 漢字表記 |
| `pos` | 詞性（動詞、名詞、形容詞等） |
| `pos_details` | 詞性細節（一段動詞、五段動詞等） |
| `definition_ja` | 日文定義（來自スーパー大辞林） |
| `definition_en` | 英文翻譯（來自ウィズダム和英辞典） |

## 中日共用漢字處理

### 問題說明

許多漢字詞彙在中文和日文中都存在（如「勉強」「大丈夫」「人参」），macOS 字典可能返回中文結果而非日文結果。

### 識別中文結果的特徵

當 `--raw` 輸出包含以下特徵時，表示返回的是**中文字典**結果：
- 注音符號（ㄅㄆㄇ）
- 拼音標記（miǎn qiǎng）
- 倉頡碼（弓山大尸）
- 繁體中文解釋風格

### 處理策略

**步驟 1：判斷用戶意圖**

根據對話上下文判斷用戶想查的是日文還是中文：
- 本專案是日文學習系統，**預設查詢日文**
- 如果用戶明確說「中文」或「國語」，則提供中文結果

**步驟 2：查詢並檢查結果**

1. 先用 `--raw` 查詢，檢查返回的是日文還是中文結果
2. 如果是中文結果且用戶想查日文，採用以下策略：

**策略 A：用假名形式重新查詢**
```bash
# 原查詢返回中文
uv run scripts/lookup-dictionary.py 勉強 --raw
# → 返回中文注音結果

# 改用假名查詢
uv run scripts/lookup-dictionary.py べんきょう --raw
# → 可能返回日文結果
```

**策略 B：提供 AI 知識補充**

如果假名查詢也無法獲得日文結果，使用 AI 知識回答，並標註：
```
⚠️ 字典返回中文結果，以下為 AI 提供的日文解釋：

【勉強】べんきょう
詞性：名詞・サ變動詞
日文：学問や技術を学ぶこと
英文：study; learning
中文：學習、讀書
```

### 常見中日共用漢字對照

| 漢字 | 日文讀音 | 日文意思 | 中文意思 | 差異 |
|------|----------|----------|----------|------|
| 勉強 | べんきょう | 學習 | 勉強、不情願 | 意思不同 |
| 大丈夫 | だいじょうぶ | 沒問題、沒關係 | 男子漢 | 意思不同 |
| 人参 | にんじん | 胡蘿蔔 | 人參 | 指不同事物 |
| 手紙 | てがみ | 信件 | 衛生紙 | 指不同事物 |
| 娘 | むすめ | 女兒 | 媽媽 | 意思相反 |
| 先生 | せんせい | 老師、醫生 | 先生（稱呼） | 用法不同 |

## 限制

- **僅限 macOS**：依賴 DictionaryServices.framework
- **需啟用字典**：用戶必須在「字典」應用程式中啟用日文字典
- **查不到的情況**：專有名詞、新詞、複合詞可能查不到
- **中日共用漢字**：可能返回中文結果，需按上述策略處理

## 回應格式規範（必須遵守）

本節定義**統一的輸出格式**，確保一致性。格式分為**必須區塊**和**可選區塊**。

---

### 格式總覽

```
【{詞彙}】{讀音}

| 項目 | 內容 |
|------|------|
| 詞性 | {詞性} |
| 日文 | {日文定義} |
| 英文 | {英文定義} |
| 中文 | {中文定義} |

{可選區塊...}

例句：
- {日文例句}（{中文翻譯}）
```

---

### 必須區塊

所有詞彙查詢都**必須包含**以下內容：

| 區塊 | 說明 |
|------|------|
| 標題行 | `【詞彙】讀音` 格式 |
| 基本資訊表 | 詞性、日/英/中三語解釋 |
| 例句 | 至少 1 句，附中文翻譯 |

---

### 可選區塊（根據詞彙類型自動判斷）

#### 1. 活用形（動詞、形容詞）

當詞彙是動詞或形容詞時，**必須**附上活用形：

```
**活用形**：
| 形式 | 變化 |
|------|------|
| 辭書形 | 食べる |
| ます形 | 食べます |
| ない形 | 食べない |
| て形 | 食べて |
| た形 | 食べた |
```

#### 2. 敬語形式（敬語詞彙）

當詞彙涉及敬語時，**必須**說明敬語類型和使用對象：

```
**敬語形式**：
| 類型 | 形式 | 使用對象 |
|------|------|----------|
| 普通形 | 食べる | 一般場合 |
| 尊敬語 | 召し上がる | 對方/尊長的動作 |
| 謙讓語 | いただく | 自己的動作 |
| 丁寧語 | 食べます | 禮貌表達 |
```

#### 3. 使用場景（敬語、正式用語）

當詞彙有特定使用場合時，列出適用場景：

```
**使用場景**：
- 餐廳接待客人
- 向上司報告
- 商務會議
```

#### 4. 多義說明（多義詞）

當詞彙有多個含義時，分別說明：

```
**多義說明**：
| 語境 | 意思 | 例子 |
|------|------|------|
| 物理高度 | 高的 | 高い山（高山） |
| 價格 | 貴的 | 高い時計（貴的手錶） |
| 程度 | 高級的 | 品質が高い（品質高） |
```

#### 5. 中日差異（中日共用漢字）

當漢字詞彙在中文和日文有不同含義時，**必須**標註差異：

```
**⚠️ 中日差異**：
| 語言 | 讀音 | 意思 |
|------|------|------|
| 日文 | べんきょう | 學習、讀書 |
| 中文 | miǎn qiǎng | 勉強、不情願 |
```

#### 6. 注意事項（易錯用法）

當詞彙有常見錯誤用法時，用 ⚠️ 標記：

```
**⚠️ 注意事項**：
- ❌ 私は召し上がります（不能對自己用尊敬語）
- ✅ 私はいただきます（自己的動作用謙讓語）
```

---

### 完整範例

#### 範例 1：簡單名詞

```
【本】ほん

| 項目 | 內容 |
|------|------|
| 詞性 | 名詞 |
| 日文 | 文字や絵を印刷した紙を綴じたもの |
| 英文 | book |
| 中文 | 書、書本 |

例句：
- 本を読みます。（我讀書。）
```

#### 範例 2：動詞（含活用）

```
【食べる】たべる

| 項目 | 內容 |
|------|------|
| 詞性 | 一段動詞（下一段） |
| 日文 | 食物を口に入れ、かんで飲み込む |
| 英文 | eat; have a meal |
| 中文 | 吃 |

**活用形**：
| 形式 | 變化 |
|------|------|
| 辭書形 | 食べる |
| ます形 | 食べます |
| ない形 | 食べない |
| て形 | 食べて |
| た形 | 食べた |

例句：
- 朝ごはんを食べます。（我吃早餐。）
```

#### 範例 3：敬語詞彙（複雜）

```
【召し上がる】めしあがる

| 項目 | 內容 |
|------|------|
| 詞性 | 五段動詞（尊敬語） |
| 日文 | 「食べる」「飲む」の尊敬語。相手の動作を高めて敬意を示す |
| 英文 | to eat; to drink (honorific, used for others) |
| 中文 | 吃、喝（尊敬語，用於對方的動作） |

**敬語形式**：
| 類型 | 形式 | 使用對象 |
|------|------|----------|
| 普通形 | 食べる | 一般場合 |
| 尊敬語 | 召し上がる | 對方/尊長的動作 |
| 謙讓語 | いただく | 自己的動作 |

**使用場景**：
- 餐廳接待：「どうぞ召し上がってください」
- 詢問上司：「召し上がりましたか」

**活用形**：
| 形式 | 變化 |
|------|------|
| 辭書形 | 召し上がる |
| ます形 | 召し上がります |
| て形 | 召し上がって |

**⚠️ 注意事項**：
- ❌ 私は召し上がります（不能對自己用尊敬語）
- ✅ 私はいただきます（自己的動作用謙讓語）

例句：
- お客様、どうぞ召し上がってください。（客人，請慢用。）
```

#### 範例 4：多義形容詞

```
【高い】たかい

| 項目 | 內容 |
|------|------|
| 詞性 | い形容詞 |
| 日文 | 位置や程度が標準より上にあること |
| 英文 | high; tall; expensive |
| 中文 | 高的；貴的 |

**多義說明**：
| 語境 | 意思 | 例子 |
|------|------|------|
| 物理高度 | 高的 | 高い山（高山） |
| 價格 | 貴的 | 高い時計（貴的手錶） |
| 程度 | 高級的 | 品質が高い（品質高） |
| 音調 | 高音的 | 高い声（高音） |

**活用形**：
| 形式 | 變化 |
|------|------|
| 現在肯定 | 高い |
| 現在否定 | 高くない |
| 過去肯定 | 高かった |
| て形 | 高くて |

例句：
- 富士山は高い山です。（富士山是一座高山。）
- この時計は高いですね。（這隻手錶很貴呢。）
```

#### 範例 5：中日共用漢字

```
【勉強】べんきょう

| 項目 | 內容 |
|------|------|
| 詞性 | 名詞・サ變動詞 |
| 日文 | 学問や技術を学ぶこと。学習すること |
| 英文 | study; learning |
| 中文 | 學習、讀書 |

**⚠️ 中日差異**：
| 語言 | 讀音 | 意思 |
|------|------|------|
| 日文 | べんきょう | 學習、讀書 |
| 中文 | miǎn qiǎng | 勉強、不情願、差強人意 |

例句：
- 日本語を勉強しています。（我正在學日文。）
```

---

### 英文詞彙查詢格式

#### 英翻日

```
【national debt】

| 項目 | 內容 |
|------|------|
| 詞性 | noun |
| 日文翻譯 | 国家負債、国債（こくさい） |
| 備註 | 通常用單數形 |

例句：
- The national debt has increased.（国債が増加した。）
```

#### 英翻中

```
【computer】

| 項目 | 內容 |
|------|------|
| 詞性 | noun (countable) |
| 中文翻譯 | 電腦、計算機 |
| 同義詞 | PC, laptop, desktop |

例句：
- I use a computer every day.（我每天使用電腦。）
```

---

### 中文詞彙查詢格式

```
【經濟】ㄐㄧㄥ ㄐㄧˋ

| 項目 | 內容 |
|------|------|
| 注音 | ㄐㄧㄥ ㄐㄧˋ |
| 拼音 | jīng jì |
| 詞性 | 名詞 |

**解釋**：
① 關於財貨的生產、分配、消費等事項
② 節約，以較少耗費獲得較大成果
③ 經世濟民，治理國家

例句：
- 經濟發展帶來許多變化。
```

## 技術文檔

詳細的 API 說明和整合指南請參考：`doc/macos-dictionary-services.md`
